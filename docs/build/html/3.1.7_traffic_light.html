

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="de" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="de" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>3.1.7 Ampel &mdash; SunFounder Da Vinci Kit  Dokumentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
        <script src="https://ezblock.cc/readDocFile/topHead.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://ezblock.cc/readDocFile/topHead.css" type="text/css" />
    <link rel="index" title="Stichwortverzeichnis" href="genindex.html" />
    <link rel="search" title="Suche" href="search.html" />
    <link rel="next" title="3.1.8 Überhitzungsmonitor" href="3.1.8_overheat_monitor.html" />
    <link rel="prev" title="3.1.6 Bewegungssteuerung" href="3.1.6_motion_control.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> SunFounder Da Vinci Kit
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="component_list.html">Komponentenliste</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Einführung</a></li>
<li class="toctree-l1"><a class="reference internal" href="what_do_we_need.html">Was brauchen wir?</a></li>
<li class="toctree-l1"><a class="reference internal" href="preparation.html">Vorbereitung</a></li>
<li class="toctree-l1"><a class="reference internal" href="libraries.html">Bibliotheken</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpio_extension_board.html">GPIO-Erweiterungskarte</a></li>
<li class="toctree-l1"><a class="reference internal" href="download_the_code.html">Laden Sie die Kode herunter</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_output.html">1 Ausgabe</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_input.html">2 Eingabe</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="3_extension.html">3 Erweiterung</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="3.1.1_counting_device.html">3.1.1 Zählgerät</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.2_welcome.html">3.1.2 Willkommen</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.3_reversing_alarm.html">3.1.3 Alarm umkehren</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.4_smart_fan.html">3.1.4 Smart Fan</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.5_battery_indicator.html">3.1.5 Batterieanzeige</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.6_motion_control.html">3.1.6 Bewegungssteuerung</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.1.7 Ampel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Einführung</a></li>
<li class="toctree-l3"><a class="reference internal" href="#components">Komponenten</a></li>
<li class="toctree-l3"><a class="reference internal" href="#schematic-diagram">Schematische Darstellung</a></li>
<li class="toctree-l3"><a class="reference internal" href="#experimental-procedures">Experimentelle Verfahren</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#for-c-language-users"><strong>Für Benutzer in C-Sprache</strong></a></li>
<li class="toctree-l4"><a class="reference internal" href="#for-python-language-users"><strong>Für Python-Sprachbenutzer</strong></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#phenomenon-picture">Phänomen Bild</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="3.1.8_overheat_monitor.html">3.1.8 Überhitzungsmonitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.9_password_lock.html">3.1.9 Passwortsperre</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.10_alarm_bell.html">3.1.10 Alarmglocke</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.11_morse_code_generator.html">3.1.11 Morsekode-Generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.12_game_guess_number.html">3.1.12 SPIEL – Nummer Vermutung</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.13_game_10_second.html">3.1.13 SPIEL - 10 Sekunden</a></li>
<li class="toctree-l2"><a class="reference internal" href="3.1.14_game_not_not.html">3.1.14 SPIEL - Nicht nicht</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Anhang</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SunFounder Da Vinci Kit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="3_extension.html">3 Erweiterung</a> &raquo;</li>
        
      <li>3.1.7 Ampel</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/3.1.7_traffic_light.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="traffic-light">
<h1>3.1.7 Ampel<a class="headerlink" href="#traffic-light" title="Link zu dieser Überschrift">¶</a></h1>
<section id="introduction">
<h2>Einführung<a class="headerlink" href="#introduction" title="Link zu dieser Überschrift">¶</a></h2>
<p>In diesem Projekt werden wir dreifarbige LED-Lichter verwenden, um den Wechsel der Ampeln zu realisieren, und eine vierstellige 7-Segment-Anzeige wird verwendet, um das Timing jedes Verkehrszustands anzuzeigen.</p>
</section>
<section id="components">
<h2>Komponenten<a class="headerlink" href="#components" title="Link zu dieser Überschrift">¶</a></h2>
<img alt="_images/list_Traffic_Light.png" class="align-center" src="_images/list_Traffic_Light.png" />
</section>
<section id="schematic-diagram">
<h2>Schematische Darstellung<a class="headerlink" href="#schematic-diagram" title="Link zu dieser Überschrift">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 39%" />
<col style="width: 26%" />
<col style="width: 26%" />
<col style="width: 10%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>T-Karte Name</p></td>
<td><p>physisch</p></td>
<td><p>wiringPi</p></td>
<td><p>BCM</p></td>
</tr>
<tr class="row-even"><td><p>GPIO17</p></td>
<td><p>Pin 11</p></td>
<td><p>0</p></td>
<td><p>17</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO27</p></td>
<td><p>Pin 13</p></td>
<td><p>2</p></td>
<td><p>27</p></td>
</tr>
<tr class="row-even"><td><p>GPIO22</p></td>
<td><p>Pin 15</p></td>
<td><p>3</p></td>
<td><p>22</p></td>
</tr>
<tr class="row-odd"><td><p>SPIMOSI</p></td>
<td><p>Pin 19</p></td>
<td><p>12</p></td>
<td><p>10</p></td>
</tr>
<tr class="row-even"><td><p>GPIO18</p></td>
<td><p>Pin 12</p></td>
<td><p>1</p></td>
<td><p>18</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO23</p></td>
<td><p>Pin 16</p></td>
<td><p>4</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-even"><td><p>GPIO24</p></td>
<td><p>Pin 18</p></td>
<td><p>5</p></td>
<td><p>24</p></td>
</tr>
<tr class="row-odd"><td><p>GPIO25</p></td>
<td><p>Pin 22</p></td>
<td><p>6</p></td>
<td><p>25</p></td>
</tr>
<tr class="row-even"><td><p>SPICE0</p></td>
<td><p>Pin 24</p></td>
<td><p>10</p></td>
<td><p>8</p></td>
</tr>
<tr class="row-odd"><td><p>SPICE1</p></td>
<td><p>Pin 26</p></td>
<td><p>11</p></td>
<td><p>7</p></td>
</tr>
</tbody>
</table>
<img alt="_images/Schematic_three_one7.png" class="align-center" src="_images/Schematic_three_one7.png" />
</section>
<section id="experimental-procedures">
<h2>Experimentelle Verfahren<a class="headerlink" href="#experimental-procedures" title="Link zu dieser Überschrift">¶</a></h2>
<p><strong>Schritt 1:</strong> Bauen Sie die Schaltung auf.</p>
<a class="reference internal image-reference" href="_images/image254.png"><img alt="3.1.7_TrafficLight_bb" src="_images/image254.png" style="width: 6.84444in; height: 3.54097in;" /></a>
<section id="for-c-language-users">
<h3><strong>Für Benutzer in C-Sprache</strong><a class="headerlink" href="#for-c-language-users" title="Link zu dieser Überschrift">¶</a></h3>
<p><strong>Schritt 2:</strong> Verzeichnis wechseln.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pi</span><span class="o">/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">c</span><span class="o">/</span><span class="mf">3.1</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>Schritt 3:</strong> Kompilieren.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gcc</span> <span class="mf">3.1</span><span class="o">.</span><span class="mi">1</span><span class="n">_CountingDevice</span><span class="o">.</span><span class="n">c</span> <span class="o">-</span><span class="n">lwiringPi</span>
</pre></div>
</div>
<p><strong>Schritt 4:</strong> Ausführen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="o">./</span><span class="n">a</span><span class="o">.</span><span class="n">out</span>
</pre></div>
</div>
<p>Während die Kode ausgeführt wird, simulieren LEDs den Farbwechsel von Ampeln. Zuerst leuchtet die rote LED 60 Sekunden lang, dann leuchtet die grüne LED 30 Sekunden lang. Als nächstes leuchtet die gelbe LED 5 Sekunden lang auf. Danach leuchtet die rote LED erneut für 60s. Auf diese Weise wird diese Reihe von Aktionen wiederholt ausgeführt.</p>
<p><strong>Kode Erklärung</strong></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define     SDI     5</span>
<span class="cp">#define     RCLK    4</span>
<span class="cp">#define     SRCLK    1</span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">placePin</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">};</span>
<span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">number</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0xc0</span><span class="p">,</span> <span class="mh">0xf9</span><span class="p">,</span> <span class="mh">0xa4</span><span class="p">,</span> <span class="mh">0xb0</span><span class="p">,</span> <span class="mh">0x99</span><span class="p">,</span> <span class="mh">0x92</span><span class="p">,</span> <span class="mh">0x82</span><span class="p">,</span> <span class="mh">0xf8</span><span class="p">,</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x90</span><span class="p">};</span>

<span class="kt">void</span> <span class="nf">pickDigit</span><span class="p">(</span><span class="kt">int</span> <span class="n">digit</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">hc595_shift</span><span class="p">(</span><span class="kt">int8_t</span> <span class="n">data</span><span class="p">);</span>
<span class="kt">void</span> <span class="nf">clearDisplay</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">display</span><span class="p">();</span>
</pre></div>
</div>
<p>Diese Kode werden verwendet, um die Funktion der Nummeranzeige von 4-stelligen 7-Segment-Anzeigen zu realisieren. Weitere Informationen finden Sie in Kapitel 1.1.5 des Dokuments. Hier verwenden wir die Kode, um den Countdown der Ampelzeit anzuzeigen.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">const</span> <span class="kt">int</span> <span class="n">ledPin</span><span class="p">[]</span><span class="o">=</span><span class="p">{</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">};</span>

<span class="kt">int</span> <span class="n">colorState</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">lightup</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">digitalWrite</span><span class="p">(</span><span class="n">ledPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">HIGH</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">digitalWrite</span><span class="p">(</span><span class="n">ledPin</span><span class="p">[</span><span class="n">colorState</span><span class="p">],</span><span class="n">LOW</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Die Kode dienen zum Ein- und Ausschalten der LED.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">greenLight</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">yellowLight</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">redLight</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">colorState</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kt">char</span> <span class="o">*</span><span class="n">lightColor</span><span class="p">[]</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;Red&quot;</span><span class="p">,</span><span class="s">&quot;Green&quot;</span><span class="p">,</span><span class="s">&quot;Yellow&quot;</span><span class="p">};</span>
<span class="kt">int</span> <span class="n">counter</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">timer</span><span class="p">(</span><span class="kt">int</span>  <span class="n">timer1</span><span class="p">){</span>       <span class="c1">//Timer function</span>
    <span class="k">if</span><span class="p">(</span><span class="n">timer1</span> <span class="o">==</span> <span class="n">SIGALRM</span><span class="p">){</span>
        <span class="n">counter</span> <span class="o">--</span><span class="p">;</span>
        <span class="n">alarm</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">counter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">colorState</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">greenLight</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">colorState</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">yellowLight</span><span class="p">;</span>
            <span class="k">if</span><span class="p">(</span><span class="n">colorState</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">redLight</span><span class="p">;</span>
            <span class="n">colorState</span> <span class="o">=</span> <span class="p">(</span><span class="n">colorState</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;counter : %d </span><span class="se">\t</span><span class="s"> light color: %s </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">counter</span><span class="p">,</span><span class="n">lightColor</span><span class="p">[</span><span class="n">colorState</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Die Kode dienen zum Ein- und Ausschalten des Timers. Weitere Informationen finden Sie in Kapitel 1.1.5. Wenn der Timer auf Null zurückkehrt, wird colorState umgeschaltet, um die LED zu wechseln, und der Timer wird einem neuen Wert zugewiesen.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">while</span><span class="p">(</span><span class="mi">1</span><span class="p">){</span>
    <span class="n">display</span><span class="p">();</span>
    <span class="n">lightup</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">//…</span>
    <span class="n">signal</span><span class="p">(</span><span class="n">SIGALRM</span><span class="p">,</span><span class="n">timer</span><span class="p">);</span>
    <span class="n">alarm</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">loop</span><span class="p">();</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Der Timer wird in der Funktion main() gestartet. Verwenden Sie in der Funktion loop() die Schleife <strong>while(1)</strong> und rufen Sie die Funktionen von 4-stelligem 7-Segment und LED auf.</p>
</section>
<section id="for-python-language-users">
<h3><strong>Für Python-Sprachbenutzer</strong><a class="headerlink" href="#for-python-language-users" title="Link zu dieser Überschrift">¶</a></h3>
<p><strong>Schritt 2:</strong> Verzeichnis wechseln.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">pi</span><span class="o">/</span><span class="n">davinci</span><span class="o">-</span><span class="n">kit</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">raspberry</span><span class="o">-</span><span class="n">pi</span><span class="o">/</span><span class="n">python</span><span class="o">/</span>
</pre></div>
</div>
<p><strong>Schritt 3:</strong> Ausführen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python3</span> <span class="mf">3.1</span><span class="o">.</span><span class="mi">7</span><span class="n">_TrafficLight</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Während die Kode ausgeführt wird, simulieren LEDs den Farbwechsel von Ampeln. Zuerst leuchtet die rote LED 60 Sekunden lang, dann leuchtet die grüne LED 30 Sekunden lang. Als nächstes leuchtet die gelbe LED 5 Sekunden lang auf. Danach leuchtet die rote LED erneut für 60s. Auf diese Weise wird diese Reihe von Aktionen wiederholt ausgeführt. Währenddessen zeigt die 4-stellige 7-Segment-Anzeige kontinuierlich die Countdown-Zeit an.</p>
<p><strong>Kode Erklärung</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SDI</span>   <span class="o">=</span> <span class="mi">24</span>      <span class="c1">#serial data input(DS)</span>
<span class="n">RCLK</span>  <span class="o">=</span> <span class="mi">23</span>     <span class="c1">#memory clock input(STCP)</span>
<span class="n">SRCLK</span> <span class="o">=</span> <span class="mi">18</span>      <span class="c1">#shift register clock input(SHCP)</span>
<span class="n">number</span> <span class="o">=</span> <span class="p">(</span><span class="mh">0xc0</span><span class="p">,</span><span class="mh">0xf9</span><span class="p">,</span><span class="mh">0xa4</span><span class="p">,</span><span class="mh">0xb0</span><span class="p">,</span><span class="mh">0x99</span><span class="p">,</span><span class="mh">0x92</span><span class="p">,</span><span class="mh">0x82</span><span class="p">,</span><span class="mh">0xf8</span><span class="p">,</span><span class="mh">0x80</span><span class="p">,</span><span class="mh">0x90</span><span class="p">)</span>
<span class="n">placePin</span> <span class="o">=</span> <span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">clearDisplay</span><span class="p">():</span>
<span class="k">def</span> <span class="nf">hc595_shift</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">pickDigit</span><span class="p">(</span><span class="n">digit</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">display</span><span class="p">():</span>
</pre></div>
</div>
<p>Diese Kode werden verwendet, um die Funktion der Nummeranzeige eines 4-stelligen 7-Segments zu realisieren. Weitere Informationen finden Sie in Kapitel 1.1.5 des Dokuments. Hier verwenden wir die Kode, um den Countdown der Ampelzeit anzuzeigen.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ledPin</span> <span class="o">=</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">26</span><span class="p">)</span>
<span class="n">colorState</span><span class="o">=</span><span class="mi">0</span>

<span class="k">def</span> <span class="nf">lightup</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">colorState</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">ledPin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">HIGH</span><span class="p">)</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">ledPin</span><span class="p">[</span><span class="n">colorState</span><span class="p">],</span> <span class="n">GPIO</span><span class="o">.</span><span class="n">LOW</span><span class="p">)</span>
</pre></div>
</div>
<p>Die Kode dienen zum Ein- und Ausschalten der LED.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">greenLight</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">yellowLight</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">redLight</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">lightColor</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Red&quot;</span><span class="p">,</span><span class="s2">&quot;Green&quot;</span><span class="p">,</span><span class="s2">&quot;Yellow&quot;</span><span class="p">)</span>

<span class="n">colorState</span><span class="o">=</span><span class="mi">0</span>
<span class="n">counter</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">timer1</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">timer</span><span class="p">():</span>        <span class="c1">#timer function</span>
    <span class="k">global</span> <span class="n">counter</span>
    <span class="k">global</span> <span class="n">colorState</span>
    <span class="k">global</span> <span class="n">timer1</span>
    <span class="n">timer1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">timer</span><span class="p">)</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">counter</span><span class="o">-=</span><span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">counter</span> <span class="ow">is</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">if</span><span class="p">(</span><span class="n">colorState</span> <span class="ow">is</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">counter</span><span class="o">=</span> <span class="n">greenLight</span>
        <span class="k">if</span><span class="p">(</span><span class="n">colorState</span> <span class="ow">is</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">counter</span><span class="o">=</span><span class="n">yellowLight</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">colorState</span> <span class="ow">is</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">counter</span><span class="o">=</span><span class="n">redLight</span>
        <span class="n">colorState</span><span class="o">=</span><span class="p">(</span><span class="n">colorState</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span>
    <span class="k">print</span> <span class="p">(</span><span class="s2">&quot;counter : </span><span class="si">%d</span><span class="s2">    color: </span><span class="si">%s</span><span class="s2"> &quot;</span><span class="o">%</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span><span class="n">lightColor</span><span class="p">[</span><span class="n">colorState</span><span class="p">]))</span>
</pre></div>
</div>
<p>Die Kode dienen zum Ein- und Ausschalten des Timers. Weitere Informationen finden Sie in Kapitel 1.1.5. Wenn der Timer auf Null zurückkehrt, wird colorState umgeschaltet, um die LED zu wechseln, und der Timer wird einem neuen Wert zugewiesen.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup</span><span class="p">():</span>
    <span class="c1"># ...</span>
    <span class="k">global</span> <span class="n">timer1</span>
    <span class="n">timer1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Timer</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="n">timer</span><span class="p">)</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">loop</span><span class="p">():</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">display</span><span class="p">()</span>
        <span class="n">lightup</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">destroy</span><span class="p">():</span>   <span class="c1"># When &quot;Ctrl+C&quot; is pressed, the function is executed.</span>
    <span class="k">global</span> <span class="n">timer1</span>
    <span class="n">GPIO</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>
    <span class="n">timer1</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>      <span class="c1">#cancel the timer</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span> <span class="c1"># Program starting from here</span>
    <span class="n">setup</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">loop</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="n">destroy</span><span class="p">()</span>
</pre></div>
</div>
<p>Starten Sie in der Funktion setup() den Timer. In der Funktion loop() wird eine <strong>Weile True</strong> verwendet: Rufen Sie die relativen Funktionen von 4-stelligem 7-Segment und LED kreisförmig auf.</p>
</section>
</section>
<section id="phenomenon-picture">
<h2>Phänomen Bild<a class="headerlink" href="#phenomenon-picture" title="Link zu dieser Überschrift">¶</a></h2>
<img alt="_images/image255.jpeg" class="align-center" src="_images/image255.jpeg" />
</section>
</section>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="3.1.8_overheat_monitor.html" class="btn btn-neutral float-right" title="3.1.8 Überhitzungsmonitor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="3.1.6_motion_control.html" class="btn btn-neutral float-left" title="3.1.6 Bewegungssteuerung" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, sunfounder

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>